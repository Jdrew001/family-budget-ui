<ion-header [translucent]="true" class="mb-1">
  <ion-toolbar style="--border-style: none !important;">
    <ion-grid>
      <ion-row>
        <ion-col>
          <h5 class="text-left"><span class="strong">Manage</span> Budget</h5>
        </ion-col>
      </ion-row>
    </ion-grid>
    
    <ion-buttons (click)="closeBudget()" class="mr-5" slot="end">
      <ion-icon class="text-md pt-3 strong" name="close-outline"></ion-icon>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-grid>
    <ion-row>
      <ion-col>
        <app-card 
          padding="1px 0px"
          margin="0px">
          <ion-grid>
            <ion-row>
              <ion-col class="pb-1">
                <p class="pt-0 mt-0 pb-0 mb-0 text-xs light-text-color">
                  {{ manageBudgetSummary?.displayDate }}
                </p>
              </ion-col>
            </ion-row>
            <ion-row>
              <ion-col class="pt-0">
                <p class="text-xs strong">Left to Spend for next {{ manageBudgetSummary?.leftSpendingDays }} days</p>
              </ion-col>
              <ion-col class="pt-0">
                <p class="text-xs strong">{{ manageBudgetSummary?.leftSpendingAmount | currency:'USD':'symbol':'1.2-2'  }}</p>
              </ion-col>
            </ion-row>
            <ion-row>
              <ion-col class="pt-0 pb-0">
                <ion-progress-bar [value]="manageBudgetSummary?.percentageSpent"></ion-progress-bar>
              </ion-col>
            </ion-row>
            <ion-row>
              <ion-col class="pt-3 pb-0">
                <p class="text-xs strong light-text-color">$0</p>
              </ion-col>
              <ion-col class="pt-3 pb-0">
                <p class="ion-float-right light-text-color text-xs strong">{{ manageBudgetSummary?.totalBudget | currency:'USD':'symbol':'1.2-2' }}</p>
              </ion-col>
            </ion-row>
            <ion-row>
              <ion-col class="pt-4 pb-0">
                <p class="text-xs strong">Total Spent: {{ manageBudgetSummary?.totalSpent | currency:'USD':'symbol':'1.2-2' }}</p>
              </ion-col>
            </ion-row>
          </ion-grid>
        </app-card>
      </ion-col>
    </ion-row>
  </ion-grid>
  <ion-grid>
    <ion-row>
      <ion-col>
        <app-card 
          margin="5px 0px" 
          padding="5px">
          <ion-list lines="none">
            <ion-item>
              <ion-label class="text-xs pl-0 pb-0">
                <span class="strong text-xs">Total </span><span class="text-xs">Budget</span><br>
                <span>{{ manageBudgetSummary?.totalBudget | currency:'USD':'symbol':'1.2-2' }}</span>
              </ion-label>
              <ion-icon style="vertical-align: middle;" class="text-lg" [src]="'assets/icon/'+manageBudgetSummary?.totalBudgetIcon+'.svg'" color="primary"></ion-icon>
            </ion-item>
          </ion-list>
        </app-card>
      </ion-col>
      <ion-col>
        <app-card 
          margin="5px 0px" 
          padding="5px">
          <ion-list lines="none">
            <ion-item>
              <ion-label class="text-xs pl-0 pb-0">
                <span class="strong text-xs">Whats </span><span class="text-xs">Left</span><br>
                <span>{{ manageBudgetSummary?.leftSpendingAmount | currency:'USD':'symbol':'1.2-2'  }}</span>
              </ion-label>
              <ion-icon style="vertical-align: middle;" class="text-lg" [src]="'assets/icon/'+manageBudgetSummary?.totalSpentIcon+'.svg'" color="primary"></ion-icon>
            </ion-item>
          </ion-list>
        </app-card>
      </ion-col>
    </ion-row>
  </ion-grid>

  <div>
    <ion-grid>
      <ion-row class="ion-justify-content-start">
        <ion-col class="ion-align-self-end">
          <h5 class="mt-0"><strong>Categories</strong></h5>
        </ion-col>
        <ion-col class="ion-align-self-end">
          <ion-button (click)="addCategory()" size="small" color="primary" fill="clear" class="text-sm ion-float-right m-0">
            <ion-icon slot="start" name="add-outline"></ion-icon>
            Add
          </ion-button>
        </ion-col>
      </ion-row>
    </ion-grid>
  </div>

  <div>
    <app-card *ngFor="let item of manageBudgetCategories"
    margin="10px 5px 5px 5px" 
    padding="5px"
    (click)="openManageCategory(item)">
      <ion-grid>
        <ion-row class="ion-justify-content-start">
          <ion-col size="2">
            <app-circle-gauge [config]="item?.circleGuage"></app-circle-gauge>
          </ion-col>
          <ion-col>
            <p class="text-sm strong description">{{ item?.name }}</p>
            <p class="pt-0 mt-2 text-xs light-text-color strong">Remaining: {{ item?.remainingAmount | currency:'USD':'symbol':'1.2-2' }}</p>
          </ion-col> 
          <ion-col>
            <p class="text-sm strong ion-float-right">{{ item?.spentAmount | currency:'USD':'symbol':'1.2-2'  }}</p><br>
            <p class="text-xs light-text-color ion-float-right strong">Budgeted: {{ item?.budgetAmount | currency:'USD':'symbol':'1.2-2'  }}</p>
          </ion-col>
          <ion-col class="ion-align-self-center" size="1">
            <ion-icon name="chevron-forward-outline" color="primary"></ion-icon>
          </ion-col>
        </ion-row>
      </ion-grid>
    </app-card>
    <app-empty-placeholder
        [icon]="'emptyList'"
        [message]="'No categories added yet'"
        [display]="manageBudgetCategories?.length == 0"></app-empty-placeholder>
  </div>

  <app-add-category
    #addCategoryModal
    [budgetCategoryRefData]="budgetCategoryRefData"
    (onConfirm$)="onAddCategory()"></app-add-category>

    <app-manage-category #manageCategory
    ></app-manage-category>
</ion-content>
